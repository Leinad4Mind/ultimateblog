{% INCLUDE 'overall_header.html' %}
{% INCLUDECSS '@mrgoldy_ultimateblog/blogbody.css' %}
{% INCLUDECSS '@mrgoldy_ultimateblog/blogcomments.css' %}

{% if S_BLOG_RATING_ENABLED and S_BLOG_RATING_CAN %}
	<script>
			var blogRatingURL = '{{ U_BLOG_RATING | escape('js') }}';
	</script>
{% endif %}

{% if S_ULTIMATEBLOG_ENABLED and S_UB_ANNOUNCEMENT_ENABLED %}{% INCLUDE '@mrgoldy_ultimateblog/ub_announcement.html' %}{% endif %}


{% if S_BLOG_CAN_DELETE %}
	<a href="{{ U_BLOG_DELETE }}" style="float: right;" class="button" title="{{ lang('BLOG_DELETE') }}">
		<span>{{ lang('BLOG_DELETE') }}</span> <i class="icon fa-trash-o fa-fw" aria-hidden="true"></i>
	</a>
{% endif %}
{% if (S_BLOG_CAN_EDIT_USER and not S_BLOG_EDIT_LOCKED) or S_BLOG_CAN_EDIT_MOD %}
	<a href="{{ U_BLOG_EDIT }}" style="float: right;" class="button" title="{{ lang('BLOG_EDIT') }}">
		<span>{{ lang('BLOG_EDIT') }}</span> <i class="icon fa-pencil fa-fw" aria-hidden="true"></i>
	</a>
{% endif %}
{% if S_BLOG_CAN_REPORT %}
	<a href="{{ U_BLOG_REPORT }}" style="float: right;" class="button" title="{{ lang('BLOG_REPORT_BLOG') }}">
		<span>{{ lang('BLOG_REPORT_BLOG') }}</span> <i class="icon fa-exclamation fa-fw" aria-hidden="true"></i>
	</a>
{% endif %}

<input id="blog_id" hidden="hidden" value="{{ BLOG_ID }}"/>

<div itemscope itemtype="http://schema.org/BlogPosting">
	<h2 id="blog_title" itemprop="headline">{{ BLOG_TITLE }}</h2>

	<div class="panel post blog-body-panel{% if (S_BLOG_REPORTED and S_BLOG_MOD_REPORT) or (S_BLOG_UNAPPROVED and S_BLOG_MOD_APPROVE) %} reported{% endif %} bg1">
		<div class="blog-body-top bg3">
			<div class="blog-body-image"><img src="{{ BLOG_IMAGE }}" alt="{{ BLOG_TITLE }}" title="{{ BLOG_TITLE }}" width="350" height="225" /></div>
			<div class="blog-body-info">
				<span class="blog-body-author" itemprop="author">{{ AUTHOR_FULL }}</span>
				<hr>
				<dl class="details">
					<dt>{{ lang('BLOG_POSTED_ON') }}{{ lang('COLON') }}</dt><dd itemprop="dateCreated">{{ BLOG_DATE }}</dd>
					{% if BLOG_EDITS %}<dt>{{ lang('BLOG_EDIT_TOTAL') }}{{ lang('COLON') }}</dt><dd>{{ BLOG_EDITS }} ( <a href="" id="view_edits" class="hvr-icon-grow">{{ lang('BLOG_EDIT_VIEW') }}</a>)</dd>{% endif %}
					<dt>{{ lang('BLOG_COMMENTS') }}{{ lang('COLON') }}</dt><dd itemprop="commentCount">{{ COMMENTS_COUNT }}</dd>
					{% if S_BLOG_RATING_ENABLED %}
						{% if S_BLOG_RATING_CAN and not S_BLOG_RATING_LOCKED %}<dt>{{ lang('BLOG_RATING_YOUR') }}{{ lang('COLON') }}</dt><dd><a class="blog-rating" id="star-appearance" rel="score-appearance" style="text-decoration: none;"{% if BLOG_USER_RATING %} data-score="{{ BLOG_USER_RATING }}"{% endif %} data-ajax="true"></a></dd>{% endif %}
						{% if not S_BLOG_RATING_LOCKED %}
							<dt>{{ lang('BLOG_RATING_AVG') }}{{ lang('COLON') }}</dt><dd>{% if BLOG_RATING %}<span itemscope itemtype="AggregateRating"><span itemprop="ratingValue">{{ BLOG_RATING }}</span> <em>({{ BLOG_RATING_COUNT }})</em></span>{% else %}<span>{{ lang('BLOG_RATING_NONE') }}</span>{% endif %}</dd>
						{% else %}
							{% if BLOG_RATING %}<dt>{{ lang('BLOG_RATING_AVG') }}{{ lang('COLON') }}</dt><dd><span itemscope itemtype="AggregateRating"><span itemprop="ratingValue">{{ BLOG_RATING }}</span> <em>({{ BLOG_RATING_COUNT }})</em></span></dd>{% endif %}
						{% endif %}
					{% endif %}
					<dt>{{ lang('BLOG_VIEWS') }}{{ lang('COLON') }}</dt><dd>{{ BLOG_VIEWS }}</dd>
					<dt>{{ lang('BLOG_CATEGORIES') }}{{ lang('COLON') }}</dt>
					<dd>
						{% for blog_categories in loops.blog_categories %}
							<a class="hvr-wobble-horizontal" href="{{ blog_categories.U_CATEGORY }}"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> <span itemprop="articleSection">{{ blog_categories.CATEGORY_NAME }}</span></a>
							{% if not blog_categories.IS_LAST_ROW %}<br>{% endif %}
						{% endfor %}
					</dd>
				</dl>
			</div>
			<div class="blog-body-desc"><h2 itemprop="headline">{{ BLOG_TITLE }}</h2><span>“{{ BLOG_DESCRIPTION }}”</span></div>
		</div>
		<div class="blog-body-text">
			{% if (S_BLOG_REPORTED and S_BLOG_MOD_REPORT) or (S_BLOG_UNAPPROVED and S_BLOG_MOD_APPROVE) %}<p class="post-notice reported"><i class="icon fa-exclamation fa-fw icon-red" aria-hidden="true"></i><strong>{% if S_BLOG_REPORTED %}{{ lang('BLOG_REPORTED') }} <a href="{{ U_BLOG_VIEW_REPORT }}">{{ lang('POST_REPORTED') }}</a>{% else %}{{ lang('POST_UNAPPROVED') }}{% endif %}</strong></p>{% endif %}
			<p itemprop="articleBody">{{ BLOG_TEXT }}</p>
		</div>
	</div>

	{% if BLOG_EDITS and (S_BLOG_CAN_EDIT_VIEW or S_BLOG_CAN_EDIT_DELETE) %}
		<div class="panel view-edits-popup pop">
			<h3>{{ lang('BLOG_EDIT_REASONS') }}</h3>
			{% for edit_reasons in loops.edit_reasons %}
				<div class="{% if edit_reasons.S_ROW_COUNT is odd %}bg2{% else %}bg3{% endif %}">
					<a href="{{ edit_reasons.U_EDIT_DELETE }}" title="{{ lang('BLOG_EDIT_DELETE') }}" class="button button-icon-only view-edits-delete"><i class="icon fa-trash-o fa-fw" aria-hidden="true"></i><span class="sr-only">{{ lang('BLOG_EDIT_DELETE') }}</span></a>
					{{ edit_reasons.USER }} {{ lang('BLOG_EDITED_ON') }} {{ edit_reasons.TIME }}<br>
					{{ edit_reasons.TEXT }}
					<hr>
				</div>
			{% endfor %}
			<a class="view-icons-close view-edits-close-extra" href="">&times;</a>
		</div>
	{% endif %}
</div>

{% if not S_IS_BOT and S_COMMENTS_ENABLED and S_COMMENTS_CAN_VIEW %}{% INCLUDE '@mrgoldy_ultimateblog/ub_blog_comments.html' %}{% endif %}

<div class="dropdown-container dropdown-container-left dropdown-up dropdown-{{ S_CONTENT_FLOW_END }} dropdown-button-control">
	<span title="{{ lang('BLOG_VIEW_PERMISSIONS') }}" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-gavel fa-fw" aria-hidden="true"></i>
		<span class="sr-only">{{ lang('BLOG_VIEW_PERMISSIONS') }}</span>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<ul class="dropdown-contents">
			<li>{% if S_BLOG_CAN_EDIT_PERM %}{{ lang('BLOG_PERM_EDIT_CAN') }}{% else %}{{ lang('BLOG_PERM_EDIT_NOT') }}{% endif %}</li>
			<li>{% if S_BLOG_CAN_DELETE_PERM %}{{ lang('BLOG_PERM_DELETE_CAN') }}{% else %}{{ lang('BLOG_PERM_DELETE_NOT') }}{% endif %}</li>
			{% if S_COMMENTS_ENABLED %}
				<li>{% if S_COMMENTS_CAN_POST and not S_COMMENTS_LOCKED%}{{ lang('BLOG_PERM_COMMENT_CAN') }}{% else %}{{ lang('BLOG_PERM_COMMENT_NOT') }}{% endif %}</li>
				<li>{% if S_COMMENT_CAN_VIEW %}{{ lang('BLOG_PERM_COMMENT_VIEW_CAN') }}{% else %}{{ lang('BLOG_PERM_COMMENT_VIEW_NOT') }}{% endif %}</li>
			{% endif %}
			<li>{% if S_BLOG_CAN_EDIT_VIEW %}{{ lang('BLOG_PERM_EDIT_VIEW_CAN') }}{% else %}{{ lang('BLOG_PERM_EDIT_VIEW_NOT') }}{% endif %}</li>
			{% if S_BLOG_RATING_ENABLED %}
				<li>{% if not S_BLOG_RATING_LOCKED and S_BLOG_RATING_CAN %}{{ lang('BLOG_PERM_RATE_CAN') }}{% else %}{{ lang('BLOG_PERM_RATE_NOT') }}{% endif %}</li>
			{% endif %}
		</ul>
	</div>
</div>
<div class="action-bar top"></div>

{% INCLUDEJS '@mrgoldy_ultimateblog/js/ultimateblog.js' %}
{% if S_BLOG_RATING_ENABLED and S_BLOG_RATING_CAN %}{% INCLUDEJS '@mrgoldy_ultimateblog/js/raty.js' %}{% endif %}
{% INCLUDE 'overall_footer.html' %}
